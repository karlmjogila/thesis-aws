---
# - hosts: localhost
#   connection: local
#   gather_facts: no
#   environment:
#     AWS_ACCESS_KEY_ID: "{{ AWS_ACCESS_KEY_ID }}"
#     AWS_SECRET_ACCESS_KEY: "{{ AWS_SECRET_ACCESS_KEY }}"
#     AWS_REGION: "{{ AWS_REGION  }}"
#   vars_files:
#     - keys
#   tasks:
#     - name: Get VPC information
#       include_role: 
#         name: vpc
#       vars:
#         fetch_vpc_info: True
#       when: create_initial_vpc is not defined and create_initial_vpc != True

- hosts: webserver
  gather_facts: no
  become: true
  vars:
    ansible_ssh_common_args: "-o ProxyCommand='ssh -o StrictHostKeyChecking=no -i {{ private_key_location }} -W %h:%p -q ubuntu@{{ hostvars['localhost']['bastion_ip'] }}'"
  tasks:
    - name: Configure webservers
      include_role:
        name: nginx
      vars:
        configure_nginx_host: True
